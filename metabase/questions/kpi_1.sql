SELECT DISTINCT ON (a.email_address, m.date) a.email_address AS "Conta", m.date AS "Data", m.total_sent AS "Enviados", m.total_delivered AS "Entregues", m.total_replied AS "Respostas", m.total_bounced AS "Bounces", ROUND(m.reply_rate / 100.0, 2) AS "Taxa Resposta (%)", m.temperature_label AS "Temp. Campanha", TO_CHAR((m.avg_reply_latency_sec || ' second')::interval, 'HH24:MI:SS') AS "Latência Média" FROM public.metrics m JOIN public.accounts a ON m.account_id = a.id ORDER BY a.email_address, m.date, m.run_at DESC;
