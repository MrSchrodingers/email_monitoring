SELECT unnest(e.recipient_addresses) AS "Destinatário", COUNT(*) AS "Total de Bounces", STRING_AGG(DISTINCT a.email_address, ', ') AS "Contas de Origem", MAX(e.sent_datetime)::date AS "Data do Último Bounce" FROM public.emails e JOIN public.accounts a ON e.account_id = a.id WHERE e.is_bounced IS TRUE AND e.sent_datetime >= (CURRENT_DATE - INTERVAL '90 days') GROUP BY 1 ORDER BY 2 DESC LIMIT 30;
