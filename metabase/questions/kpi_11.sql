WITH latency_counts AS (SELECT CASE WHEN reply_latency_sec < 3600 THEN '01. Em menos de 1 hora' WHEN reply_latency_sec < 14400 THEN '02. Entre 1 e 4 horas' WHEN reply_latency_sec < 43200 THEN '03. Entre 4 e 12 horas' WHEN reply_latency_sec < 86400 THEN '04. Entre 12 e 24 horas' ELSE '05. Mais de 24 horas' END AS "Faixa de Latência", COUNT(*) AS "Total de Respostas" FROM public.emails WHERE is_replied = true AND sent_datetime >= (CURRENT_DATE - INTERVAL '90 days') GROUP BY 1) SELECT "Faixa de Latência", "Total de Respostas", ROUND(100.0 * "Total de Respostas" / SUM("Total de Respostas") OVER(), 2) AS "Percentual (%)" FROM latency_counts ORDER BY 1;
